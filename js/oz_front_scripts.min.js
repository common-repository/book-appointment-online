!function(e){var t,a=new Array,o=0;function n(a,i=16.666667,o=!1,n=!1){if(stopAnimation)return!1;if(clearTimeout(t),stopAnimation=!0,0==i)i=16.66667;if(1==n)var r=i+"%";else r="-"+i+"%";if(e(a).off("click"),void 0!==e(a).attr("style")){r=CSSJSON.toJSON(e(a).attr("style")).attributes.transform.split("(")[1].split("%")[0];if(0==n)r=r-i+"%";else r=(r=Number(r)+Number(i))+"%"}if(!r||Math.round(parseFloat(r))>0)return!1;e(a).css({transform:"translateX("+r+")"}),"function"==typeof o&&setTimeout(o(),700);var s=new CustomEvent("animateNextEv",{detail:{selector:a,left:r,reverse:n}});document.addEventListener("animateNextEv",function(){},!1),document.dispatchEvent(s),t=setTimeout(function(){stopAnimation=!1;var e=new CustomEvent("animateNextEvAfter",{detail:{selector:a,left:r,reverse:n}});document.addEventListener("animateNextEvAfter",function(){},!1),document.dispatchEvent(e)},700)}function r(t,a,i=30,o=[],r=null){time=[],timeB=[],b=Number(i);var m=!0;if(""==o){e("body").addClass("oz_load");m=!1;var l=e(".oz_service.active").attr("data-ids")?e(".oz_service.active").attr("data-ids"):"",d={action:"dayRaspis",dateText:r,ids:l};e.ajax({data:d,type:"POST",url:oz_vars.oz_ajax_url,success:function(i,o){e("body").removeClass("oz_load");var l=i;n(".oz_hid_carousel"),Array.isArray(t)&&s(l,r,m,t.length,t,a)}})}m&&(n(".oz_hid_carousel"),s(o,r,m,t.length,t,a))}function s(t,a,o=!0,r=0,s=0,m=0){var u=moment();if("string"==typeof t){var c=JSON.parse(t);e.each(c,function(e,t){if(a==t.dayStart){var i=t.w_time;timeB.push({start:t.timeStart,w_time:i,id:t.pers_id})}})}else t.pop();if(r>0){for(var p=0;p<r;p++)dHStart=Number(s[p].min.split(":")[0]),dMStart=Number(s[p].min.split(":")[1]),dHFinish=Number(m[p].split(":")[0]),dMFinish=Number(m[p].split(":")[1]),pId=s[p].pId,l(a,r,pId);time=time.filter(function(e,t,a){var o=[];for(i=0;i<a.length;i++)o.push(a[i].time);return t==o.indexOf(e.time)}),time=time.sort(function(e,t){e=e.time?e.time:e,t=t.time?t.time:t;return parseInt(e.replace(":",""))-parseInt(t.replace(":",""))})}else l(a);e(".oz_service.active").length||time.pop(),e(".timeRange").remove(),e(".inlinedatepicker").length&&(e('<ul class="timeRange" />').insertAfter(".inlinedatepicker"),timerU=!0,timerD=!0,timerE=!0,jQuery.each(time,function(e,t){var a=t.pId?t.pId:"";t=t.time?t.time:t;timerU&&t.split(":")[0]<12&&(jQuery(".timeRange").append('<li class="zagday squaredThree">'+oz_lang.str2+"</li>"),timerU=!1),t.split(":")[0]>11&&t.split(":")[0]<18&&timerD&&(jQuery(".timeRange").append('<li class="zagday squaredThree">'+oz_lang.str3+"</li>"),timerD=!1),t.split(":")[0]>17&&timerE&&(jQuery(".timeRange").append('<li class="zagday squaredThree">'+oz_lang.str4+"</li>"),timerE=!1);var i=moment(t,"HH:mm").locale(oz_vars.lang.split("_")[0]).format(oz_vars.timeFormat);jQuery(".timeRange").append(' <li class="squaredThree"><input id="time-'+e+'" data-pId="'+a+'" class="checkb" type="checkbox" value="'+t+'" name="oz_time_rot" /><label for="time-'+e+'">'+i+"</label></li>")})),jQuery("#genertimelist").html(""),jQuery.each(time,function(e,t){var a=jQuery("input#oz_time_rot").val()==t?"checked":"",i=(t=t.time?t.time:t).pId?t.pId:"";jQuery("#genertimelist").append(' <li class="squaredThree"><input class="checkb" data-pId="'+i+'" type="checkbox" '+a+' value="'+t+'" name="oz_time_rot" /><label for="squaredThree">'+t+"</label></li>")}),function(t){jQuery("input.checkb").on("change",function(){jQuery("input#oz_time_rot").val(jQuery(this).val()),jQuery("input.checkb").not(this).prop("checked",!1);var a=jQuery(this).val(),i=e(".personal.active .pname").attr("data-id");e('#timeForm .oz-form input[name="oz_start_date_field_id"]').val(t),e('#timeForm .oz-form input[name="oz_time_rot"]').val(a),e('#timeForm .oz-form input[name="oz_personal_field_id"]').val(i)})}(a),function(t=!0,a="",i=""){jQuery("input.checkb").on("change",function(){e(this).attr("data-pId")&&e('input[name="oz_personal_field_id"]').val(e(this).attr("data-pId"));var a=jQuery(this).val(),o=moment(a,"HH:mm").locale(oz_vars.lang.split("_")[0]).format(oz_vars.timeFormat);if(e(".oz_zapis_info .oz_time_info").text(o),t||(n(".oz_hid_carousel"),e(".stepname").html(oz_lang.str5)),jQuery("input#oz_time_rot").val(jQuery(this).val()),jQuery("input.checkb").not(this).prop("checked",!1),t){var r=9999;if(e.each(i,function(e,t){var i=d(t.start)-d(a);i>0&&i<r&&(r=i)}),"undefined"!=typeof dHFinish&&"undefined"!=typeof dMFinish){var s=d(dHFinish+":"+dMFinish)-d(a);s<r&&(r=s)}!function(t,a){e("body").addClass("oz_load"),e(".listUslug, .uslugas").remove();var i=e(".personal.active .pname").attr("data-usl"),o=e(".personal.active .pname").attr("data-id"),r={action:"listUslug",ids:i,id:o,minRange:a};e.ajax({data:r,type:"POST",url:oz_vars.oz_ajax_url,success:function(t,a){e("body").removeClass("oz_load"),e(".listUslug").remove(),e('<ul class="listUslug" />').insertAfter(".timeRange"),e(".listUslug").html(t),n(".oz_hid_carousel"),e(".stepname").html(oz_lang.str6),e(".usluga").click(function(){var t=e(this).attr("id").split("-")[1];e('#timeForm input[name="oz_uslug_set"]').val(t),e(".oz_zapis_info .oz_usluga_info span").text(e(this).find("p").text()),n(".oz_hid_carousel",void e("#timeForm").addClass("tf-ten")),e(".stepname").html(oz_lang.str7)})}})}(0,r)}})}(o,a,timeB);moment()}function m(e){var t=new Array,a=moment().format("X");for(i=0;i<e.length;i++){var o=void 0===e[i].time?e[i]:e[i].time;moment(o,"h:mm").format("X")>a&&t.push(e[i])}return t}function l(t=0,a=0,i=0){b=void 0!==oz_vars.timeslot?parseInt(oz_vars.timeslot):b;for(var o=moment().format("DD.MM.YYYY"),n=60*dHStart+dMStart;n<=1440;n+=b)if(d=Math.floor(n/60),minutes=n%60,minutes<10&&(minutes="0"+minutes),d<10&&(d="0"+d),!(24===d||d<dHStart||d==dHStart&&minutes<dMStart||d>dHFinish||d==dHFinish&&minutes>dMFinish)){var r=timeB.map(function(e){return e.start}).indexOf(d+":"+minutes);if(r>-1){if(l=""!=timeB[r].w_time&&parseInt(minutes)+parseInt(timeB[r].w_time)){if(l<10&&(l="0"+l),l>=60){var s=Math.floor(l/60),l=l%60,d=parseInt(d)+s;d<10&&(d="0"+d),l<10&&(l="0"+l)}var u=d+":"+l}timeB[r].id==i&&timeB.splice(r,1)}else{if(e(".oz_service.active").length){var c=e(".oz_service.active").attr("data-mintime"),p=0,f=d+":"+minutes,_=Math.abs(parseInt(moment(dHFinish+":"+dMFinish,"h:mm").format("X"))-parseInt(moment(f,"h:mm").format("X")))/60;if(_<c)continue;for(k=0;k<timeB.length;k++){(Math.abs(parseInt(moment(timeB[k].start,"h:mm").format("X"))-parseInt(moment(f,"h:mm").format("X")))/60<c||_<c)&&p++}}if(p)continue;if(l){if(parseInt(moment(u,"h:mm").format("X"))<=parseInt(moment(d+":"+minutes,"h:mm").format("X"))){i?time.push({time:d+":"+minutes,pId:i}):time.push(d+":"+minutes);l=!1}}else i?time.push({time:d+":"+minutes,pId:i}):time.push(d+":"+minutes)}}o==t&&(time=m(time))}function d(e){var t=e.split(":");return 60*parseInt(t[0])+parseInt(t[1])}function u(t={},a="",i={}){t=function(t){var a=moment(),i=[],o=[];e.each(t,function(e){void 0!==t[e].day&&i.push(t[e])}),i.length&&jQuery.each(i,function(e,t){var a=moment();for(e=0;e<60;e++){if("oz_"+a.locale("en").format("ddd").toLowerCase()==t.day){a.format("YYYY-MM-DD");var i=t.pId?t.pId:"";o.push({day:a.format("YYYY-MM-DD"),start:t.start,end:t.end,pId:i})}a.add(1,"days")}});var n=o,r=moment()-a;return console.log("Время генерации рабочих дней: "+r+"мс"),n}(i),e(".inlinedatepicker").datepicker({minDate:0,maxDate:"1M",beforeShowDay:function(a){var i=[],o=e.datepicker.formatDate("yy-mm-dd",a),n=moment().format("YYYY-MM-DD"),r=0;if(t.map(function(e,a){return e.day==o&&i.push(t[a]),e.day}).indexOf(o)>-1&&i.length){var s="";for(var m in i)if(s+="time-"+i[m].start+"-"+i[m].end+"-"+i[m].pId+" ",o==n&&moment()>=moment(i[m].end,"HH:mm"))r=0;else r=1}return[r,s]},dateFormat:"dd.mm.yy",onSelect:function(t,o){var n=o.selectedDay,s=o.selectedMonth,m=o.selectedYear,l=e(o.dpDiv).find('[data-year="'+m+'"][data-month="'+s+'"]').filter(function(){return e(this).find("a").text().trim()==n}),d=moment(t,"DD.MM.YYYY").locale(oz_vars.lang.split("_")[0]).format(oz_vars.dateFormat);e(".oz_zapis_info .oz_date_info").text(d);e(this).datepicker("getDate").getUTCDay();var u=[],c=[];e.each(e(l).attr("class").split(" "),function(e,t){if(t.indexOf("time-")>-1){parseInt(t.split("-")[1].replace(":","")),parseInt(t.split("-")[2].replace(":",""));var a=t.split("-")[3]?t.split("-")[3]:"";u.push({min:t.split("-")[1],pId:a}),c.push(t.split("-")[2])}});r(u||i[0].start,c||i[0].end,15,a,t)}})}function c(){e(".personal").click(function(){e(".personal, .oz_service").removeClass("active"),e(this).addClass("active"),n(".oz_hid_carousel"),e(".inlinedatepicker, .uslugas").remove();e('<div class="inlinedatepicker" />').insertAfter(".personals");var t=e(this).find(".pname").attr("data-days"),a=e(this).find(".pname").attr("data-raspis");TimeWeek=JSON.parse(t),e(".stepname").html(oz_lang.str9);var i=e(this).find(".pname").text();""!=i?(e(".oz_zapis_info .oz_spec_info").show(),e(".oz_zapis_info .oz_spec_info span").text(i)):e(".oz_zapis_info .oz_spec_info").hide(),u(t,a,TimeWeek)})}function p(){var t=e(".oz_container").width();t<992&&t>767?e(".oz_container").addClass("oz_width_xl_tablet").removeClass("oz_width_mob oz_width_tablet"):t<768&&t>481?e(".oz_container").addClass("oz_width_tablet").removeClass("oz_width_mob"):t<481?(e(".oz_container").addClass("oz_width_mob"),document.addEventListener("animateNextEv",function(t){e(".oz_popup").length?e("#oz_overlay").stop().animate({scrollTop:e(".oz_container").offset().top}):e("html, body").stop().animate({scrollTop:e(".oz_container").offset().top})},!1)):e(".oz_container").removeClass("oz_width_mob oz_width_tablet oz_width_xl_tablet")}stopAnimation=!1,document.addEventListener("animateNextEv",function(t){if(0==t.detail.reverse){var i=e(".oz_container .stepname").text();a.indexOf(i)<0&&a.push(i),o++}else o--,e(".oz_container .stepname").text(a[o]);a.length;Math.round(parseFloat(t.detail.left))>=0?(e(".oz_back_btn").addClass("fadeOutTop"),a.splice(0,a.length)):e(".oz_back_btn").removeClass("fadeOutTop"),o<=0&&e('.oz-form input.chist[type="hidden"]').val(""),1==o&&e(".oz_zapis_info .oz_spec_info").hide()},!1),e(".oz_back_btn").click(function(){n(".oz_hid_carousel",!1,!1,!0)}),e("#rememSms").change(function(){e(".remList").toggleClass("hide"),1==e(this).prop("checked")?e('input[name="oz_remList"]').val(e(".remDef").attr("data-rem")):e('input[name="oz_remList"]').val("")}),e(".remDef").text(e(".spisokRem ul li").eq(0).text()).attr("data-rem",e(".spisokRem ul li").eq(0).attr("data-time")).click(function(){var t=e(this).parent();t.hasClass("oz_open")?t.removeClass("oz_open"):t.addClass("oz_open")}),e(".spisokRem li").click(function(){e(".remDef").text(e(this).text()).attr("data-rem",e(this).attr("data-time")),e(".remList").removeClass("oz_open"),e('input[name="oz_remList"]').val(e(".remDef").attr("data-rem"))}),e("#timeForm .oz-form").submit(function(t){t.preventDefault();var a=e(this).find('input[aria-required="true"]'),i=e(this);if(fl=!0,a.length&&a.each(function(t,a){""==e(a).val()&&(e(a).addClass("req"),setTimeout(function(){e(a).removeClass("req")},2e3),fl=!1)}),fl){e("body").addClass("oz_load");var o=function(e){for(var t={},a=0;a<e.length;a++)t[e[a].name]=e[a].value;return t}(e(this).serializeArray());e.ajax({data:o,type:"POST",url:oz_vars.oz_ajax_url,success:function(t,a){i.trigger("reset"),e("body").removeClass("oz_load"),e(".oz_zapis_info").html('<svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg> <p class="oz_check">'+oz_lang.str1+"</p>"),e(".form_fields").slideUp(),e(".oz_back_btn").addClass("fadeOutTop");var o=new CustomEvent("ozBookSend",{detail:{response:t}});document.addEventListener("ozBookSend",function(){},!1),document.dispatchEvent(o)}})}}),e(document).ready(function(){e('input[name="clientEmail"]').inputmask(),e(".oz_vibor .oz_btn").click(function(){e("body").addClass("oz_load");var t=e(this).parents(".filial").attr("id").split("-")[1],a=e(this).attr("data-atup"),i={action:"check"+a,id:t,type:a};e.ajax({data:i,type:"POST",url:oz_vars.oz_ajax_url,success:function(t,i){e("."+a+"s").remove(),e('<ul class="'+a+'s" />').insertAfter(".filials"),e("body").removeClass("oz_load"),n(".oz_hid_carousel"),"usluga"==a?(e(".stepname").html(oz_lang.str6),e(".personals").remove()):e(".stepname").html(oz_lang.str10),e("."+a+"s").html(t),c()},error:function(t){t.status&&(e(".oz_err").remove(),e(".stepname").append('<span class="oz_err"> Error '+t.status+"! "+oz_lang.str11),e("body").removeClass("oz_load"))}})})}),"undefined"!=typeof persStart&&persStart&&c(),p(),e(window).resize(function(){p()}),e(".oz_pop_btn").click(function(){e("#oz_overlay").fadeIn("fast"),setTimeout(function(){e(".oz_popup").show(),p()},50),setTimeout(function(){e(".oz_popup").addClass("open")},200)}),e("#oz_overlay .close").click(function(){e(".oz_popup").removeClass("open"),setTimeout(function(){e("#oz_overlay, .oz_popup").hide()},250)}),e("#oz_overlay").click(function(t){e(t.target).closest("#oz_overlay .oz_popup").length||(e(".oz_popup").removeClass("open"),setTimeout(function(){e("#oz_overlay, .oz_popup").hide()},250))}),document.addEventListener("ozBookSend",function(e){""!=oz_vars.redirect_url&&setTimeout(function(){window.location.href=oz_vars.redirect_url},1500)},!1)}(jQuery);class ozUI{constructor(){this.active="",this.options=oz_vars,this.stepHeight=null,this.autoheight()}autoheight(){var e=this;this.options.autoheight&&document.addEventListener("animateNextEvAfter",function(){jQuery(".oz_hid_carousel").children().each(function(){var t=jQuery(".oz_hid")[0].getBoundingClientRect().left,a=jQuery(this)[0];if(Math.abs(t-a.getBoundingClientRect().left)<=8){e.active=jQuery(this);var i=new CustomEvent("onAnimateEnd",{detail:{target:a}});document.addEventListener("onAnimateEnd",function(){},!1),document.dispatchEvent(i),jQuery(this).addClass("oz_inview"),jQuery(".oz_hid").css({height:jQuery(this).get(0).scrollHeight})}else jQuery(this).removeClass("oz_inview")})},!1)}}const oz=new ozUI;